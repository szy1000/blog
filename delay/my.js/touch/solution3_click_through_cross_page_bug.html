<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0" />
    <meta name="format-detection" content="telephone=no" />
    <title>测试my.js的touch方法，解决跨页面点透问题</title>
    <script src="../my.js"></script>
    <script src="touch.js"></script>
    <style>
    em {
        display: block;
        color: red;
        font-style: normal;
    }
    .clickme {
        background-color: #eee;
        cursor: pointer;
        border: 1px solid red;
    }
    </style>
</head>
<body>
    <div id="console"></div>
    <script>
    function log() {
        var args = arguments;
        var str = '';

        var console = document.getElementById('console');

        for (var i = 0; i < args.length; i++) {
            str += args[i].toString();
            if (i < args.length - 1) {
                str += ', ';
            }
        }
        str += '<br>';

        console.innerHTML += str;
    }
    </script>
    <h1>测试my.js的touch方法，解决跨页面点透问题</h1>

    <h2>解法3：fastclick</h2>

    <div id="mask" style="display: none; position: fixed; top: 0; left: 0; z-index: 10; width: 100%; height: 1000px; background-color: #eee; text-align: center;">
        点击会消失
    </div>

    <h3>fastclick</h3>
    
    <!-- 使用fastclick -->
    <script src="lib/fastclick.js"></script>
    <script>
    if ('addEventListener' in document) {
        document.addEventListener('DOMContentLoaded', function() {
            FastClick.attach(document.body);
        }, false);
    }
    </script>


    <p id="ele_touch_tap2" class="clickme" style="height: 100px;">点击弹出mask，点击mask消失<em>且不跳转</em>，页面跳转则存在点透bug</p>
    <a id="a" href="error.html" style="display: inline-block; background-color: blue; width: 100%; height: 100px;">跳转链接，在mask弹出时点击此块区域，验证跨页面点透bug</a>
    <em></em>
    <script>
    function showMask() {
        // 用my.js
        // m$('#mask').show().on(function(e) {
        //     // alert(e.target.innerHTML);
        //     var that = this;

        //     m$(that).hide();
        // });
        

        // 用原生js
        var ele_mask = document.getElementById('mask');

        ele_mask.style.display = '';
        ele_mask.addEventListener('click', function() {
            ele_mask.style.display = 'none';
        }, false);

    }
    m$('#ele_touch_tap2').tap(function() {
        showMask();
    });
    </script>

<!-- 
    <h3>zepto: $(str).tap(handler)</h3>
    <script src="lib/zepto116.min.js"></script>
    <script src="lib/zepto_touch.js"></script>
    <p id="ele_touch_tap3" class="clickme" style="height: 100px;">点击弹出mask，点击mask消失<em>且不跳转</em>，页面跳转则存在点透bug</p>
    <a id="a2" href="error.html" style="display: inline-block; background-color: blue; width: 100%; height: 100px;">跳转链接，在mask弹出时点击此块区域，验证跨页面点透bug</a>
    <em></em>
    <script>
    $('#ele_touch_tap3').tap(function() {
        showMask();
    });
    </script>
-->
</body>
</html>